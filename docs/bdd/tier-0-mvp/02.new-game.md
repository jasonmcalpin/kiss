# Feature: New Game Creation

## User Story
As a player, I want to start a new game so that I can play with other players and choose different factions with unique abilities and characteristics.

## Acceptance Criteria
- [ ] Player can create a new game with custom settings
- [ ] Player can select from available factions with unique abilities
- [ ] Player can join existing games created by others
- [ ] Player can leave a game they are participating in
- [ ] Game initializes properly with selected faction attributes
- [ ] Game board is set up correctly for all players

## BDD Scenarios

### Scenario 1: Player Creates a New Game
**Given** I am logged into the game  
**When** I click "Create New Game"  
**And** I enter game name "Galactic Conquest"  
**And** I set maximum players to 4  
**And** I select game settings (turn time, victory conditions)  
**And** I click "Create Game"  
**Then** a new game should be created  
**And** I should be the game host  
**And** I should see the game lobby  

### Scenario 2: Player Selects a Faction
**Given** I am in a game lobby  
**And** factions are available for selection  
**When** I click on "Terran Federation" faction  
**And** I review the faction's unique abilities  
**And** I click "Select Faction"  
**Then** my faction should be set to "Terran Federation"  
**And** I should see the faction's starting attributes  
**And** other players should see my faction selection  

### Scenario 3: Player Starts a New Game
**Given** I am the game host  
**And** all players have selected their factions  
**When** I click "Start Game"  
**Then** the game board should be initialized  
**And** each player should start with their faction's default resources  
**And** the turn order should be established  
**And** the first player should be notified it's their turn  

### Scenario 4: Player Joins an Existing Game
**Given** there are available games in the lobby  
**When** I click on "Galactic Conquest" game  
**And** I see the game has 2/4 players  
**And** I click "Join Game"  
**Then** I should be added to the game  
**And** I should see the faction selection screen  
**And** other players should be notified I joined  

### Scenario 5: Player Leaves a Game
**Given** I am in an ongoing game  
**When** I click the "Leave Game" button  
**And** I confirm "Yes, leave game"  
**Then** I should be removed from the game  
**And** other players should be notified I left  
**And** my nation should become AI-controlled or be eliminated  
**And** I should return to the main lobby  

### Scenario 6: Game Cannot Start Without Minimum Players
**Given** I am the game host  
**And** only 1 player (myself) is in the game  
**When** I try to click "Start Game"  
**Then** I should see an error message "Need at least 2 players to start"  
**And** the game should not start  

### Scenario 7: Faction Selection Conflict Resolution
**Given** I am in a game lobby  
**And** another player has already selected "Terran Federation"  
**When** I try to select "Terran Federation"  
**Then** I should see a message "Faction already taken"  
**And** I should be prompted to select a different faction  

## Implementation Notes

### Database Requirements
- games table: id, name, host_id, max_players, status, settings, created_at
- game_players table: game_id, player_id, faction_id, status, joined_at
- factions table: id, name, description, abilities, starting_resources

### API Endpoints
- POST /api/games - Create new game
- GET /api/games - List available games
- POST /api/games/{id}/join - Join existing game
- DELETE /api/games/{id}/leave - Leave game
- POST /api/games/{id}/start - Start game (host only)
- PUT /api/games/{id}/faction - Select faction

### Frontend Components
- Game creation form
- Game lobby list
- Faction selection interface
- Game lobby with player list
- Leave game confirmation dialog

## Status
- [ ] Database schema for games and factions
- [ ] Game creation API endpoint
- [ ] Join/leave game API endpoints
- [ ] Faction selection API endpoint
- [ ] Game lobby frontend component
- [ ] Faction selection frontend component
- [ ] Game creation form
- [ ] Real-time updates for lobby changes
- [ ] Tests written
- [ ] Feature complete
